# AI 表情包本地网页开发详细需求文档

本项目旨在开发一个本地运行的网页版 AI 表情包生成工具。用户通过输入表情包主体描述和一系列关键词，即可调用 AI 模型（即梦 AI 官方 Node.js SDK）生成一套表情包图片，并利用前端技术进行尺寸合成、文字添加和水印展示。最终，用户可以打包下载符合微信表情包平台规范的压缩包。

**核心技术栈：** Next.js (React) + SCSS + 即梦 AI Node.js SDK

**即梦 AI Node.js SDK：** https://github.com/volcengine/volc-sdk-nodejs
**即梦 AI 图像生成接入文档：**https://www.volcengine.com/docs/85621/1537648#ie5aupr9 
**即梦 AI 主要用于鉴权，详见 公共参数 - 签名参数 - 在Header中的场景部分：**https://www.volcengine.com/docs/6369/67268


**部署方式：** 本地运行（需要 Node.js 环境），通过 `npm run dev` 或 `npm start` 启动。

---

## 1. 核心功能需求

### 1.1. 表情包生成与预览

#### 1.1.1. 输入界面 (Next.js Page/Component)

* **UI 布局：** 页面顶部或侧边提供清晰的输入区域，包含两个主要的文本输入框。
* **输入字段：**
    * **表情包主体描述 (String):**
        * **描述：** 用户描述表情包主角及其主要特征。
        * **字数限制：** 建议 ≤ 50 字。
        * **占位符/提示：** "例如：简单背景，穿着黑色短袖的男人"
    * **16 个关键词描述 (Array of Strings):**
        * **描述：** 用户输入与表情包情感或动作相关的关键词，将对应生成 16 张表情。
        * **数量：** 强制要求 16 个关键词。
        * **字数限制：** 每个关键词建议 ≤ 5 字。
        * **输入方式：** 考虑提供多行文本输入框，或 16 个独立的输入框，方便用户填写。
        * **占位符/提示：** "例如：开心大笑, 思考人生, 震惊, 委屈, 加油, 疑问..." (可提供逗号分隔的示例)。
* **文案指引 (需求 4):**
    * 在每个输入框下方或旁边，提供清晰的**文案指引**和**示例**，引导用户书写稳定、具体、有利于 AI 理解的关键词和描述。
    * **示例指引内容：**
        * **主体描述指引：** "请尽可能具体地描述表情包的主角及其主要特征，例如‘一只戴眼镜的黄色柴犬’，这将影响 AI 生成的基础形象。"
        * **关键词描述指引：** "请填写与表情包情感或动作相关的词语，例如‘开心大笑’、‘思考人生’、‘震惊得说不出话’。请避免使用过于抽象或复杂的词语，确保每个词语都能清晰表达一种情绪或动作。"
        * **可考虑添加：** "热门关键词" 或 "推荐关键词" 列表，作为可选辅助输入，提升用户体验。

#### 1.1.2. AI 模型调用 (Next.js API Route)

* **触发方式：** 前端提供一个“生成表情包”按钮。
* **API Route 实现 (`pages/api/generate-emojis.js` 或 `app/api/generate-emojis/route.js`):**
    * 前端（客户端）通过 `Axios` 向 Next.js 的自定义 API Route (`/api/generate-emojis`) 发送 POST 请求，传递主体描述和 16 个关键词。
    * 在 **API Route (Node.js 环境)** 中：
        * 导入并使用**即梦 AI 官方 Node.js SDK**。
        * 安全地从环境变量中读取即梦 AI 的 API Key。
        * 根据前端传入的描述和关键词，调用即梦 AI SDK 的相应方法生成 16 张表情包图片数据（通常是 Base64 编码或图片 URL）。
        * **错误处理：** 捕获即梦 AI API 调用可能发生的错误，并向前端返回友好的错误信息（例如：AI 生成失败、API 调用限制等）。
        * 返回 AI 生成的图片数据给前端。
* **加载状态：** 在前端发送 API 请求期间，禁用生成按钮，并显示加载动画或进度条，告知用户当前状态。

#### 1.1.3. 图片生成与预览展示 (Next.js Page/Component)

* **前端图片处理：**
    * 接收 API Route 返回的图片数据。
    * 利用 `Canvas API` 或其他前端图片处理库，对每张图片进行以下处理：
        * **尺寸合成：** 将 AI 生成的图片调整或裁剪为符合微信表情包平台要求的特定尺寸。
        * **文字添加：**
            * 将用户输入的**关键词**（或根据关键词生成的对应文字）作为文字内容，叠加到对应的表情包图片上。
            * **字体样式：** 字体需要清晰可辨，并与表情包风格协调（可选择一个默认字体，或预设几种字体供后续选择）。
            * **字体颜色：** 考虑与图片背景形成对比，保证可见性。
            * **文字位置：** 文字需放置在图片底部中央或合适位置，避免遮挡表情主体。
            * **智能调整 (未来优化):** 理想情况下，文字位置和大小能根据图片内容进行智能调整。
        * **水印展示 (需求 1):**
            * 在每张生成的表情包图片上添加**透明水印**。
            * **水印内容：** 可预设为“AI 生成”或“本站出品”等文字或小 Logo。
            * **水印样式：** 字体、颜色、大小、透明度需适中，不影响表情包的正常使用和美观。
            * **水印位置：** 可放置在图片角落（例如右下角），确保不干扰主体。
* **预览区：**
    * 在页面上展示 16 张经过处理后的表情包图片。
    * 每张图片下方显示对应的关键词。
    * **尺寸选择 (需求 6):** 在预览时，统一选择一个合适的微信表情包尺寸进行展示（如 **240x240px**），以保证页面布局和加载速度。
    * *(后续迭代考虑：提供尺寸切换功能，让用户预览不同尺寸的效果)*

### 1.2. 表情包下载

* **下载按钮：** 提供一个“下载表情包 ZIP”按钮，位置醒目。
* **打包下载 (需求 6):**
    * 点击按钮后，前端利用 `JSZip` 库，将所有 16 张表情包图片，按照微信表情包平台要求的**多个尺寸**进行打包。
    * **微信表情包尺寸要求 (已更新，基于提供的图片规范):**
        * **主图 (16 张):**
            * **尺寸:** `240x240px`
            * **文件名:** `01.png`, `02.png` ... `16.png`
            * **处理逻辑:** 直接使用 AI 生成图，并在此基础上叠加文字和水印。
        * **缩略图 (16 张):**
            * **尺寸:** `120x120px`
            * **文件名:** `01-thumb.png`, `02-thumb.png` ... `16-thumb.png`
            * **处理逻辑:** 将 `240x240px` 的主图**等比缩放**到 `120x120px`，并进行**锐化**处理以保持清晰度。
        * **聊天页图标 (16 张):**
            * **尺寸:** `50x50px`
            * **文件名:** `01-icon.png`, `02-icon.png` ... `16-icon.png`
            * **处理逻辑:** 将 `240x240px` 的主图进行**中心裁剪**到 `50x50px`，并添加**边框**（边框样式和颜色待定，可考虑白色或与表情包风格一致的颜色）。
        * **详情页横幅 (1 张):**
            * **尺寸:** `750x400px`
            * **文件名:** `banner.png`
            * **处理逻辑:** 将**前 3 张主图**（`01.png`, `02.png`, `03.png`）进行**拼接**，并在其上方或下方叠加**文字标题**（文字内容可由用户输入，或预设为“AI 生成表情包”等）。拼接方式可考虑横向拼接。
    * **图片格式：** 所有图片需为 PNG 格式，带透明背景。
    * **文件命名：** 压缩包内的图片文件应严格按规范命名，并按类型进行清晰的文件夹分类，方便用户上传。
        * 例如，压缩包内可包含 `main/` (主图), `thumb/` (缩略图), `icon/` (图标), `banner/` (横幅) 等文件夹。
* **下载流程：** 触发浏览器下载，将生成的 ZIP 文件保存到用户本地。

---

## 2. 技术栈细节

* **前端框架：** **Next.js (React)**
    * 利用 React 组件化开发模式，构建清晰的 UI 组件。
    * 通过 API Routes 实现安全的后端逻辑和 AI API 调用。
    * Next.js 提供的路由、代码分割等优化。
* **CSS 预处理器：** **SCSS**
    * 提供变量、嵌套、混入等功能，提高 CSS 编写效率和可维护性。
    * 可结合 CSS Modules 实现组件级样式隔离。
* **HTTP 请求：** **Axios** (用于前端向 Next.js API Routes 发送请求)
* **AI API 调用：** **即梦 AI 官方 Node.js SDK** (在 Next.js API Routes 中使用，安全管理 API Key)。
* **图片处理：**
    * **Canvas API：** 用于在前端进行图片尺寸调整、裁剪、文字绘制、水印添加、锐化、拼接等复杂图像处理。
    * **JSZip：** 用于在浏览器端生成 ZIP 压缩包，打包表情包图片。
    * *(可选) `sharp` 或 `Jimp`：如果前端的图片处理性能或功能遇到瓶颈，可考虑将部分复杂的图片处理（如锐化、带边框的裁剪等）放到 Next.js 的 API Route 中使用 Node.js 库来完成，再将处理后的图片传回前端。但初步建议优先在前端完成。*

---

## 3. 界面交互与用户体验 (UX)

* **响应式设计：** 考虑在不同屏幕尺寸下的布局和显示效果 (初步可专注桌面端)。
* **错误提示：** 对用户输入不规范、API 调用失败等情况给出友好的错误提示。
* **反馈机制：** 当 AI 生成图片时，提供进度指示，避免用户等待时无反馈。
* **简洁性：** 界面设计应力求简洁直观，减少用户学习成本。

---

## 4. 本地运行与分享注意事项

* **运行环境：** 项目需要 Node.js 环境才能启动。
    * 用户需安装 Node.js (推荐 LTS 版本)。
    * 在项目根目录下运行 `npm install` 安装依赖。
    * 运行 `npm run dev` (开发模式) 或 `npm run build` 后 `npm start` (生产模式) 来启动应用。
* **分享给朋友：**
    * 你需要将整个 Next.js 项目文件夹打包给朋友。
    * 朋友解压后，需要按照上述“运行环境”的步骤来启动应用程序。
    * **无法通过 `next export` 导出为纯静态文件一键访问，因为核心的 AI 调用逻辑 (`/api/generate-emojis`) 依赖于 Next.js 的 Node.js 服务器。**

---